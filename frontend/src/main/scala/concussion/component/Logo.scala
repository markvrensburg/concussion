package concussion
package component

import scala.concurrent.duration._
import scalatags.Text.svgAttrs.{filter => _, modifier => _, _}
import scalatags.Text.svgTags._

import scala.util.Random
import scalacss.ProdDefaults._

object Logo {

  object Style extends StyleSheet.Inline {

    import dsl._

    val pulse = keyframes(
      0.%% -> style(opacity(0.3), transform := "scale(1.0)"),
      50.%% -> style(opacity(0.6), transform := "scale(1.05)"),
      100.%% -> style(opacity(0.3), transform := "scale(1.0)")
    )

    val logoWrapper = style(unsafeRoot("#logo-wrapper")(
      width(100.vw),
      height(100.vh),
      display.flex,
      justifyContent.stretch,
      overflow.hidden
    ))

    val logoGrid = style(unsafeRoot("#logo-grid")(
      display.grid,
      justifyContent.stretch,
      backgroundColor(rgba(0,0,0,0.7)),
      padding(10.px),
      columnGap(10.px),
      rowGap(10.px),
      width(100.vw),
      height(100.vh)
    ))

    val logoContainer = style(unsafeRoot(".logo-container")(
      height(100.%%),
      display.flex,
      overflow.hidden
    ))

    val logo = style(unsafeRoot(".logo")(
      height(80.%%),
      width(80.%%),
      margin.auto,
      animationName(pulse),
      animationDuration(15.seconds),
      animationIterationCount.infinite,
      animationDirection.alternate
    ))

    val pathStyle = style(unsafeRoot("path")(
      &.hover(
        filter := "url(#glow)"
      )))
  }

  private val sections = List(
    "m 95.023215,257.61488 6.803565,9.82739 6.80358,2.64583 6.80357,10.96131 14.36309,13.98512 7.18155,-0.75595 -3.77976,-14.3631 -9.82738,-5.66964 -1.51191,-6.4256 -8.31547,-6.42559 4.91369,-4.15774 -6.4256,-6.04762 -6.04762,4.53571 z",
    "m 133.19881,279.91548 7.9375,-0.75595 5.66964,-6.4256 -16.25298,-1.88988 -8.69345,-3.02381 1.51191,6.4256 z",
    "m 187.62738,205.83215 -5.66964,4.15774 -13.22917,5.29166 7.9375,14.74107 5.29167,-3.77976 9.07143,9.82738 3.0238,-17.76488 z",
    "m 191.02917,236.07024 -4.61012,7.72833 -4.27631,-0.53453 -8.55262,0.53453 -2.40543,-4.00904 5.48138,-9.76691 5.29167,-3.77976 z",
    "m 182.14274,243.26404 4.27631,0.53453 -12.02712,9.62171 -17.37252,-7.48355 -22.18337,-0.53454 -1.06908,-5.07812 15.7689,-11.75986 9.6217,-1.87089 10.95805,5.61266 6.55046,-2.28336 -5.48138,9.76691 2.40543,4.00904 z",
    "m 112.03214,251.18929 6.76773,-5.25256 5.34539,2.40543 4.00904,-2.6727 6.68174,-0.26727 22.18337,0.53454 17.37252,7.48355 0.80181,7.48354 -7.21628,9.35444 -11.75986,3.20723 -9.41165,-0.73156 -16.25298,-1.88988 -8.69345,-3.02381 -8.31547,-6.42559 4.91369,-4.15774 z",
    "m 44.766206,235.78049 1.069079,6.94901 12.828939,12.56166 9.888971,2.13816 -12.828937,-15.50163 1.870888,-2.40543 -0.80181,-4.00904 z",
    "m 56.793336,235.51322 0.534538,-5.87993 -17.105249,-2.13816 -9.354433,-4.27631 -9.888973,-0.53454 -4.276312,-5.34539 -2.672695,-8.28535 -5.6126604,0.8018 -3.2072344,5.07813 10.6907818,13.36347 14.699824,6.41447 14.165283,1.06908 z",
    "m 57.327874,229.63329 11.759859,16.30344 26.459685,5.61266 -10.156243,7.21628 -10.690781,0.26727 -6.147199,-1.60362 -12.828937,-15.50163 1.870888,-2.40543 -0.80181,-4.00904 z",
    "m 118.79987,245.93673 -9.35444,-1.06908 0.26727,-8.28535 14.96709,-3.74178 9.08717,7.48355 1.06908,5.07812 -6.68174,0.26727 -4.00904,2.6727 z",
    "m 95.547418,251.54939 6.681732,0.26727 0.53455,-6.68174 6.68173,-0.26727 9.35444,1.06908 -6.76773,5.25256 -6.04762,4.53571 -10.961305,1.88988 -9.63204,1.15079 z",
    "m 83.787557,233.37506 v 0 l -2.672694,-4.81085 16.570711,-1.33635 9.888976,-3.4745 0.53454,-7.48355 -9.35444,-6.68173 -17.372518,4.54358 -12.828937,6.41447 -11.225321,9.08716 11.759859,16.30344 z",
    "m 83.787557,233.37506 14.432555,4.81085 11.492588,-1.60361 -0.26727,8.28535 -6.68173,0.26727 -0.53455,6.68174 -6.681732,-0.26727 -26.459685,-5.61266 z",
    "m 107.57455,223.75336 6.68173,4.54358 22.45064,-10.15624 15.76891,2.67269 -2.93997,7.75082 -15.7689,11.75986 -9.08717,-7.48355 -14.96709,3.74178 -11.492588,1.60361 -14.432555,-4.81085 -2.672694,-4.81085 16.570711,-1.33635 z",
    "m 152.47583,220.81339 4.54358,-10.15624 2.40542,-20.04521 -8.28535,-12.2944 15.50163,-4.27631 6.41447,12.56167 -4.32701,28.67865 7.9375,14.74107 -6.55046,2.28336 -10.95805,-5.61266 -9.6217,1.87089 z",
    "m 166.64111,174.04123 0.53454,-6.1472 14.16528,15.7689 5.34539,14.43256 0.94106,7.73666 -5.66964,4.15774 -13.22917,5.29166 4.32701,-28.67865 z",
    "m 167.17565,167.89403 -10.95805,-6.1472 -5.07812,16.57071 15.50163,-4.27631 z",
    "m 8.4175516,209.85534 -5.0781211,-2.13815 0.2672696,-6.68174 12.0271289,-20.57975 4.543582,0.26727 7.750816,-2.40543 2.939965,17.37252 -2.939965,5.34539 -10.156242,2.93996 -3.741773,5.07813 z",
    "m 27.928227,201.03545 12.561667,6.68174 -5.612659,8.81989 -8.819896,0.80181 4.810853,5.87993 -9.888973,-0.53454 -4.276312,-5.34539 -2.672695,-8.28535 3.741773,-5.07813 z",
    "m 68.553195,220.54613 -18.441598,-5.34539 -9.621703,-7.48355 -5.612659,8.81989 -8.819896,0.80181 4.810853,5.87993 9.354433,4.27631 17.105249,2.13816 z",
    "m 27.928227,178.31754 -1.870888,-5.87993 5.345393,-7.75082 12.828937,1.60362 -4.543584,13.36348 3.207237,9.35443 5.078119,4.54358 -7.483547,14.16529 -12.561667,-6.68174 2.939965,-5.34539 z",
    "m 20.177411,180.72297 -2.138156,-5.34539 13.363477,-10.69079 -5.345393,7.75082 1.870888,5.87993 z",
    "m 98.75465,209.58808 10.42351,-4.54359 27.79603,0.53454 20.04522,5.07812 -4.54358,10.15624 -15.76891,-2.67269 -22.45064,10.15624 -6.68173,-4.54358 0.53454,-7.48355 z",
    "m 151.13948,178.31754 -6.1472,12.2944 5.34539,4.81085 -3.20723,6.41447 -10.15625,3.74177 20.04522,5.07812 2.40542,-20.04521 z",
    "m 156.2176,161.74683 -9.88897,-1.60362 -7.75082,7.21628 -5.61266,10.95805 5.61266,17.10525 6.41447,-4.81085 6.1472,-12.2944 z",
    "m 138.57781,195.42279 -12.02713,-0.26727 -10.15624,-2.93996 -7.21628,12.82893 27.79603,0.53454 10.15625,-3.74177 3.20723,-6.41447 -5.34539,-4.81085 z",
    "m 116.39444,192.21556 4.27631,-16.57072 -3.74177,-8.28535 16.03617,10.95805 5.61266,17.10525 -12.02713,-0.26727 z",
    "m 116.92898,167.35949 3.20723,-12.2944 5.07812,-2.40543 2.93997,8.55263 10.42351,6.1472 -5.61266,10.95805 z",
    "m 156.2176,161.74683 -2.40543,-5.07812 -12.2944,-4.27631 -1.06907,-4.27632 -10.69078,0.26727 -4.27632,-4.27631 -10.42351,0.53454 -3.4745,4.81085 8.55262,5.61266 5.07812,-2.40543 2.93997,8.55263 10.42351,6.1472 7.75082,-7.21628 z",
    "m 116.92898,167.35949 -8.28536,-1.06908 -8.28535,4.27631 -6.949008,14.16529 1.870884,10.95805 -3.474503,7.75082 6.949007,6.1472 10.42351,-4.54359 7.21628,-12.82893 4.27631,-16.57071 z",
    "m 108.64362,166.29041 2.93997,-6.41447 -6.68174,-6.1472 6.68174,-4.27631 8.55262,5.61266 -3.20723,12.2944 z",
    "m 42.895322,189.00832 11.225318,-9.88897 3.474506,13.63075 5.612659,4.00904 -8.285356,5.87993 7.483547,7.48354 6.147199,10.42352 -18.441598,-5.34539 -9.621703,-7.48355 7.483547,-14.16529 z",
    "m 63.207805,196.75914 6.949006,9.6217 11.225321,7.75082 -12.828937,6.41447 -6.147199,-10.42352 -7.483547,-7.48354 z",
    "m 98.75465,209.58808 -16.837978,-6.41447 -6.414468,-11.49259 -6.1472,4.81085 -6.147199,0.26727 6.949006,9.6217 11.225321,7.75082 z",
    "m 93.409262,184.73201 -6.68174,-2.13816 -13.898015,3.47451 -8.285355,-5.87993 -4.009044,-5.61266 -6.414468,4.54358 3.474506,13.63075 5.612659,4.00904 6.147199,-0.26727 6.1472,-4.81085 6.414468,11.49259 16.837978,6.41447 -6.949009,-6.1472 3.474503,-7.75082 z",
    "m 60.535108,174.57577 11.225321,-8.28536 6.949009,6.41447 6.949006,-1.60362 -0.534538,6.1472 1.603616,5.34539 -13.898015,3.47451 -8.285355,-5.87993 z",
    "m 70.424082,154.79782 1.336347,11.49259 -11.225321,8.28536 -6.414468,4.54358 -11.225318,9.88897 -3.207237,-9.35443 4.543584,-13.36348 z",
    "m 100.35827,170.56672 -10.156242,-13.63074 14.699822,-3.20724 6.68174,6.1472 -2.93997,6.41447 z",
    "m 90.202028,156.93598 -6.1472,-4.54358 1.603616,-7.21628 -12.294396,5.34539 -2.939966,4.27631 1.336347,11.49259 6.949009,6.41447 6.949006,-1.60362 z",
    "m 85.658444,145.17612 8.285355,-0.80181 2.405425,2.93997 6.949006,-4.00905 11.75986,1.33635 -3.4745,4.81085 -6.68174,4.27631 -14.699822,3.20724 -6.1472,-4.54358 z",
    "m 90.202028,156.93598 -4.543584,14.16528 -0.534538,6.1472 1.603616,5.34539 6.68174,2.13816 6.949008,-14.16529 z",
    "m 44.231669,166.29041 26.192413,-11.49259 2.939966,-4.27631 -10.958052,-1.06908 -15.501633,4.00904 -15.501631,11.22532 z"
  )

  import scalatags.Text.implicits._

  private def createPaths(r: Random) = sections.zipWithIndex.map(section => {
    path(
      id := s"section${section._2+1}",
      d := section._1,
      style := s"fill:#ffffff;fill-opacity:${0.4 + (0.75 - 0.4) * r.nextDouble};fill-rule:evenodd;",
    )
  })

  def apply(r: Random): String =
    svg(`class` := "logo", viewBox := "0 0 200 160",
      g(style := "display:inline", transform := "translate(0,-140)",
        defs(
          filter(id := "glow",
            feGaussianBlur(`class` := "blur", result := "coloredBlur", stdDeviation := "1"),
            feMerge(
              feMergeNode(in := "coloredBlur"),
              feMergeNode(in := " SourceGraphic")
            )
          )
        ),
        modifier(createPaths(r): _*)
      )
    ).render
}
